@echo off
chcp 65001 >nul
powershell.exe -ExecutionPolicy Bypass -NoProfile -Command "$scriptPath = '%~dp0archive.ps1'; $scriptDir = '%~dp0'.TrimEnd('\'); $arg1 = '%~1'; $arg2 = '%~2'; $passwordFlags = @('--no-password', '-nopass', '/nopass'); $targetPath = $null; $passwordFlag = $null; if ($arg1 -in $passwordFlags) { $passwordFlag = $arg1; if ($arg2 -ne '' -and $arg2 -ne $null) { $targetPath = $arg2 } } elseif ($arg2 -in $passwordFlags) { $passwordFlag = $arg2; if ($arg1 -ne '' -and $arg1 -ne $null) { $targetPath = $arg1 } } else { if ($arg1 -ne '' -and $arg1 -ne $null) { $targetPath = $arg1 } }; $psArgs = @($scriptDir); if ($targetPath -ne $null -and $targetPath -ne '') { $psArgs += $targetPath }; if ($passwordFlag -ne $null -and $passwordFlag -ne '') { $psArgs += $passwordFlag }; $env:ARCHIVE_SCRIPT_DIR = $scriptDir; $content = [System.IO.File]::ReadAllText($scriptPath, [System.Text.Encoding]::UTF8); [Console]::OutputEncoding = [System.Text.Encoding]::UTF8; $OutputEncoding = [System.Text.Encoding]::UTF8; $scriptBlock = [scriptblock]::Create($content); & $scriptBlock @psArgs"

